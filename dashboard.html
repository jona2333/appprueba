<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Gesti√≥n - Proyectos y Equipo</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header principal -->
        <header class="header">
            <h1>
                <i class="fas fa-tachometer-alt"></i>
                Dashboard de Gesti√≥n
            </h1>
            <div class="header-actions">
                <button class="btn btn-primary" onclick="openTeamMemberModal()">
                    <i class="fas fa-users"></i>
                    Miembros de Equipo
                </button>
                <div class="header-time">
                    <i class="fas fa-clock"></i>
                    <span id="current-time">--:--:--</span>
                </div>
            </div>
        </header>

        <!-- Navegaci√≥n entre secciones -->
        <nav class="dashboard-nav">
            <button class="nav-btn active" data-section="projects">
                <i class="fas fa-project-diagram"></i>
                Proyectos
            </button>
            <button class="nav-btn" data-section="team">
                <i class="fas fa-users"></i>
                Equipo
            </button>
            <button class="nav-btn" data-section="assignments">
                <i class="fas fa-tasks"></i>
                Asignaciones
            </button>
        </nav>

        <!-- Estad√≠sticas globales -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">üìä</div>
                <div class="stat-value" id="total-projects">0</div>
                <div class="stat-label">Proyectos Totales</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üë•</div>
                <div class="stat-value" id="total-members">0</div>
                <div class="stat-label">Miembros del Equipo</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">‚ö°</div>
                <div class="stat-value" id="productivity-score">0</div>
                <div class="stat-label">Puntuaci√≥n de Productividad</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üìà</div>
                <div class="stat-value" id="completion-rate">0%</div>
                <div class="stat-label">Tasa de Finalizaci√≥n</div>
            </div>
        </div>

        <!-- Secci√≥n de Proyectos -->
        <section id="projects-section" class="dashboard-section active">
            <div class="section-header">
                <h2><i class="fas fa-project-diagram"></i> Gesti√≥n de Proyectos</h2>
                <div class="section-actions">
                    <button class="btn btn-success" onclick="showProjectForm()">
                        <i class="fas fa-plus"></i>
                        Nuevo Proyecto
                    </button>
                </div>
            </div>

            <!-- Formulario de proyecto -->
            <div id="project-form-container" class="form-container" style="display: none;">
                <form id="project-form" class="project-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="project-name">Nombre del Proyecto</label>
                            <input type="text" id="project-name" name="project-name" required 
                                   placeholder="Ingresa el nombre del proyecto" maxlength="100">
                        </div>
                        <div class="form-group">
                            <label for="project-priority">Prioridad</label>
                            <select id="project-priority" name="project-priority" required>
                                <option value="alta">üî¥ Alta</option>
                                <option value="media" selected>üü° Media</option>
                                <option value="baja">üü¢ Baja</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="project-description">Descripci√≥n</label>
                        <textarea id="project-description" name="project-description" 
                                  placeholder="Describe el proyecto detalladamente" 
                                  rows="3" maxlength="500" required></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i>
                            Crear Proyecto
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="hideProjectForm()">
                            <i class="fas fa-times"></i>
                            Cancelar
                        </button>
                    </div>
                </form>
            </div>

            <!-- Lista de proyectos -->
            <div id="projects-container" class="projects-container">
                <!-- Los proyectos se renderizan aqu√≠ din√°micamente -->
            </div>

            <!-- Gr√°fico de proyectos -->
            <div class="chart-container">
                <h3>Estado de Proyectos</h3>
                <div class="chart-wrapper">
                    <canvas id="projects-chart"></canvas>
                </div>
            </div>
        </section>

        <!-- Secci√≥n de Miembros del Equipo -->
        <section id="team-section" class="dashboard-section">
            <div class="section-header">
                <h2><i class="fas fa-users"></i> Gesti√≥n de Equipo</h2>
                <div class="section-actions">
                    <div class="search-bar">
                        <input type="text" id="team-search" placeholder="Buscar miembros..." class="search-input">
                        <i class="fas fa-search"></i>
                    </div>
                    <select id="team-filter-role" class="filter-select">
                        <option value="">Todos los roles</option>
                        <option value="Developer">Desarrollador</option>
                        <option value="Designer">Dise√±ador</option>
                        <option value="Manager">Manager</option>
                        <option value="Analyst">Analista</option>
                    </select>
                    <select id="team-filter-department" class="filter-select">
                        <option value="">Todos los departamentos</option>
                        <option value="IT">IT</option>
                        <option value="Marketing">Marketing</option>
                        <option value="Sales">Ventas</option>
                        <option value="HR">RRHH</option>
                    </select>
                    <button class="btn btn-success" onclick="showTeamMemberForm()">
                        <i class="fas fa-user-plus"></i>
                        Agregar Miembro
                    </button>
                </div>
            </div>

            <!-- Estad√≠sticas del equipo -->
            <div class="team-stats">
                <div class="team-stat-card">
                    <div class="stat-icon">üë®‚Äçüíª</div>
                    <div class="stat-value" id="developers-count">0</div>
                    <div class="stat-label">Desarrolladores</div>
                </div>
                <div class="team-stat-card">
                    <div class="stat-icon">üé®</div>
                    <div class="stat-value" id="designers-count">0</div>
                    <div class="stat-label">Dise√±adores</div>
                </div>
                <div class="team-stat-card">
                    <div class="stat-icon">üëî</div>
                    <div class="stat-value" id="managers-count">0</div>
                    <div class="stat-label">Managers</div>
                </div>
                <div class="team-stat-card">
                    <div class="stat-icon">üè¢</div>
                    <div class="stat-value" id="departments-count">0</div>
                    <div class="stat-label">Departamentos</div>
                </div>
            </div>

            <!-- Lista de miembros del equipo -->
            <div id="team-members-container" class="team-members-container">
                <!-- Los miembros se renderizan aqu√≠ din√°micamente -->
            </div>

            <!-- Gr√°ficos del equipo -->
            <div class="charts-grid">
                <div class="chart-container">
                    <h3>Distribuci√≥n por Roles</h3>
                    <div class="chart-wrapper">
                        <canvas id="roles-chart"></canvas>
                    </div>
                </div>
                <div class="chart-container">
                    <h3>Distribuci√≥n por Departamentos</h3>
                    <div class="chart-wrapper">
                        <canvas id="departments-chart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Secci√≥n de Asignaciones -->
        <section id="assignments-section" class="dashboard-section">
            <div class="section-header">
                <h2><i class="fas fa-tasks"></i> Asignaciones de Proyectos</h2>
            </div>
            <div id="assignments-container" class="assignments-container">
                <!-- Las asignaciones se renderizan aqu√≠ din√°micamente -->
            </div>
        </section>

        <!-- Modal para gesti√≥n de miembros del equipo -->
        <div id="team-member-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="member-modal-title">Agregar Miembro del Equipo</h3>
                    <button class="close-btn" onclick="closeTeamMemberModal()">&times;</button>
                </div>
                <form id="team-member-form" class="member-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="member-name">Nombre Completo</label>
                            <input type="text" id="member-name" name="name" required 
                                   placeholder="Nombre completo del miembro" maxlength="100">
                        </div>
                        <div class="form-group">
                            <label for="member-email">Email</label>
                            <input type="email" id="member-email" name="email" required 
                                   placeholder="email@empresa.com">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="member-role">Rol</label>
                            <select id="member-role" name="role" required>
                                <option value="">Seleccionar rol</option>
                                <option value="Developer">üë®‚Äçüíª Desarrollador</option>
                                <option value="Designer">üé® Dise√±ador</option>
                                <option value="Manager">üëî Manager</option>
                                <option value="Analyst">üìä Analista</option>
                                <option value="Tester">üß™ Tester</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="member-department">Departamento</label>
                            <select id="member-department" name="department" required>
                                <option value="">Seleccionar departamento</option>
                                <option value="IT">üíª IT</option>
                                <option value="Marketing">üìà Marketing</option>
                                <option value="Sales">üíº Ventas</option>
                                <option value="HR">üë• RRHH</option>
                                <option value="Finance">üí∞ Finanzas</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="member-phone">Tel√©fono</label>
                            <input type="tel" id="member-phone" name="phone" 
                                   placeholder="N√∫mero de tel√©fono">
                        </div>
                        <div class="form-group">
                            <label for="member-status">Estado</label>
                            <select id="member-status" name="status" required>
                                <option value="active">‚úÖ Activo</option>
                                <option value="inactive">‚ùå Inactivo</option>
                                <option value="vacation">üå¥ En vacaciones</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="member-skills">Habilidades (separadas por comas)</label>
                        <input type="text" id="member-skills" name="skills" 
                               placeholder="JavaScript, React, Node.js, etc.">
                    </div>
                    <div class="form-group">
                        <label for="member-location">Ubicaci√≥n</label>
                        <input type="text" id="member-location" name="location" 
                               placeholder="Ciudad, Pa√≠s">
                    </div>
                    <input type="hidden" id="member-id" name="id">
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i>
                            <span id="member-submit-text">Agregar Miembro</span>
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="closeTeamMemberModal()">
                            <i class="fas fa-times"></i>
                            Cancelar
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Sistema de notificaciones -->
        <div id="notification" class="notification"></div>

        <!-- Controles de productividad -->
        <div class="productivity-container">
            <button onclick="calculateProductivity()" class="btn btn-info">
                <i class="fas fa-calculator"></i>
                Calcular Productividad
            </button>
            <div id="productivity-result" class="productivity-result"></div>
        </div>

        <!-- Controles de datos -->
        <div class="data-controls">
            <button onclick="storage.export()" class="btn btn-outline">
                <i class="fas fa-download"></i>
                Exportar Datos
            </button>
            <input type="file" id="import-file" accept=".json" style="display: none;" onchange="handleImport(this)">
            <button onclick="document.getElementById('import-file').click()" class="btn btn-outline">
                <i class="fas fa-upload"></i>
                Importar Datos
            </button>
            <button onclick="storage.clear()" class="btn btn-danger">
                <i class="fas fa-trash"></i>
                Limpiar Todo
            </button>
        </div>
    </div>

    <!-- Scripts -->
    <script src="script.js"></script>
    <script>
        // Variables globales para el manejo de miembros del equipo
        let currentEditingMember = null;
        let filteredMembers = [];

        // Navegaci√≥n entre secciones
        function showSection(sectionName) {
            // Ocultar todas las secciones
            document.querySelectorAll('.dashboard-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Mostrar la secci√≥n seleccionada
            document.getElementById(sectionName + '-section').classList.add('active');
            
            // Actualizar navegaci√≥n
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-section="${sectionName}"]`).classList.add('active');
        }

        // Event listeners para navegaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const section = this.getAttribute('data-section');
                    showSection(section);
                    
                    // Renderizar contenido espec√≠fico de la secci√≥n
                    if (section === 'team') {
                        TeamMemberManager.render();
                    } else if (section === 'assignments') {
                        AssignmentManager.render();
                    }
                });
            });
        });

        // Funciones globales para el formulario de proyectos
        function showProjectForm() {
            document.getElementById('project-form-container').style.display = 'block';
            document.getElementById('project-name').focus();
        }

        function hideProjectForm() {
            document.getElementById('project-form-container').style.display = 'none';
            document.getElementById('project-form').reset();
        }

        // Funciones para el modal de miembros del equipo
        function openTeamMemberModal() {
            showSection('team');
            showTeamMemberForm();
        }

        function showTeamMemberForm(member = null) {
            const modal = document.getElementById('team-member-modal');
            const title = document.getElementById('member-modal-title');
            const submitText = document.getElementById('member-submit-text');
            const form = document.getElementById('team-member-form');
            
            if (member) {
                // Modo edici√≥n
                title.textContent = 'Editar Miembro del Equipo';
                submitText.textContent = 'Actualizar Miembro';
                currentEditingMember = member;
                
                // Llenar formulario con datos existentes
                document.getElementById('member-id').value = member.id;
                document.getElementById('member-name').value = member.name;
                document.getElementById('member-email').value = member.email;
                document.getElementById('member-role').value = member.role;
                document.getElementById('member-department').value = member.department;
                document.getElementById('member-phone').value = member.phone || '';
                document.getElementById('member-status').value = member.status;
                document.getElementById('member-skills').value = member.skills ? member.skills.join(', ') : '';
                document.getElementById('member-location').value = member.location || '';
            } else {
                // Modo creaci√≥n
                title.textContent = 'Agregar Miembro del Equipo';
                submitText.textContent = 'Agregar Miembro';
                currentEditingMember = null;
                form.reset();
                document.getElementById('member-id').value = '';
            }
            
            modal.classList.add('show');
            document.getElementById('member-name').focus();
        }

        function closeTeamMemberModal() {
            const modal = document.getElementById('team-member-modal');
            modal.classList.remove('show');
            currentEditingMember = null;
            document.getElementById('team-member-form').reset();
        }

        // Funciones de utilidad ya existentes que mantenemos
        function updateProgress(id, change) {
            ProjectManager.updateProgress(id, change);
        }

        function deleteProject(id) {
            ProjectManager.delete(id);
        }

        function editProject(id) {
            ProjectManager.edit(id);
        }

        function handleImport(input) {
            if (input.files && input.files[0]) {
                storage.import(input.files[0]);
            }
        }
    </script>
</body>
</html>